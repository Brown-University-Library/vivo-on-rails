<button type="button" class="btn btn-link btn-sm search-toggle-more-categories"
  data-toggle="modal" data-target="#modal_form_<%= facet.name %>"
  title="Show more categories from this facet">
    <small class="glyphicon glyphicon-plus"></small>&nbsp;<span>More…</span>
</button>

<!-- Modal -->
<div id="modal_form_<%= facet.name %>" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"><%= facet.title %></h4>
      </div>
      <div class="modal-body">
        <% id_prefix = "modal_form_" + facet.name %>
        <% page_size = 20 %>
        <% page_count = (facet.values.count / page_size).to_i + ((facet.values.count % page_size) == 0 ? 0 : 1) %>
        <!-- use these input boxes to preserve state -->
        <input id="<%= id_prefix %>_page_num" value="1" class="hidden">
        <input id="<%= id_prefix %>_page_count" value="<%= page_count %>" class="hidden">
        <!-- items added via RenderFacet() JavaScript call (see below)-->
        <div>
          <ul id="<%= id_prefix %>_items">
          </ul>
        </div>
      </div> <!-- modal body -->
      <div class="modal-footer">
        <a id="<%= id_prefix %>_prev_link" href="javascript:GoPrevPage('<%= facet.name %>');" class="btn btn-default pull-left" role="button" title="See previous group of facets">« Previous</a>
        <a id="<%= id_prefix %>_next_link" href="javascript:GoNextPage('<%= facet.name %>');" class="btn btn-default pull-left" role="button" title="See next group of facets">Next »</a>
        <a id="<%= id_prefix %>_sort_az" href="javascript:SortFacetByValue('<%= facet.name %>');" class="btn btn-default pull-right" role="button" title="Sort facets alphabetically (ascending)">A-Z</a>
        <a id="<%= id_prefix %>_sort_num" href="javascript:SortFacetByCount('<%= facet.name %>');" class="btn btn-default pull-right active" role="button" title="Sort facets by count (descending)">9-0</a>
      </div>
    </div> <!-- modal content -->

  </div> <!-- modal-dialog -->
</div> <!-- modal_form -->

<script>
  <% facet.values.each_with_index do |value, index| %>
    <% addUrl = search_url() + "?" + @presenter.search_qs + "&fq=" + facet.to_qs(value.text) %>
    <% removeUrl = value.remove_url %>
    AddFacetValue("<%= facet.name %>", "<%= value.text %>", <%= value.count %>, "<%= addUrl %>", "<%= removeUrl %>");
  <% end %>
  RenderFacet("<%= facet.name %>");
</script>
